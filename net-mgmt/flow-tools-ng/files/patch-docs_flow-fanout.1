--- docs/flow-fanout.1.orig	2018-11-12 23:15:59 UTC
+++ docs/flow-fanout.1
@@ -0,0 +1,116 @@
+.\" This manpage has been automatically generated by docbook2man 
+.\" from a DocBook document.  This tool can be found at:
+.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
+.\" Please send any bug reports, improvements, comments, patches, 
+.\" etc. to Steve Cheng <steve@ggi-project.org>.
+.TH "FLOW-FANOUT" "1" "12 November 2018" "" ""
+
+.SH NAME
+flow-fanout \- Fanout (replicate) flow exports to many destinations.
+.SH SYNOPSIS
+
+\fBflow-fanout\fR [ \fB-h\fR ] [ \fB-A\fI AS0_substitution\fB\fR ] [ \fB-d\fI debug_level\fB\fR ] [ \fB-f\fI filter_fname\fB\fR ] [ \fB-F\fI filter_definition\fB\fR ] [ \fB-m\fI privacy_mask\fB\fR ] [ \fB-p\fI pidfile\fB\fR ] [ \fB-s\fR ] [ \fB-S\fI stat_interval\fB\fR ] [ \fB-V\fI pdu_version\fB\fR ] [ \fB-x\fI xmit_delay\fB\fR ] \fB\fIlocalip/remoteip/port\fB\fR \fB\fIlocalip/remoteip/port\fB\fR\fI ...\fR
+
+.SH "DESCRIPTION"
+.PP
+The \fBflow-fanout\fR utility will replicate flows arriving
+on localip/remoteip/port to destination(s) specified by localip/remoteip/port.
+.PP
+Flows processed by multiple exporters will be mixed into a single output
+stream.  This functionality appeared to support Cisco Catalyst exports and
+may have other uses.
+.PP
+A SIGQUIT or SIGTERM signal will cause \fBflow-fanout\fR to exit.
+.SH "OPTIONS"
+.TP
+\fB-A\fI AS0_substitution\fB\fR
+Cisco's NetFlow exports represent the local autonomous system as 0 instead of
+the real value.  This option can be used to replace the 0 in the export with
+the a configured value.  Unfortunately under certain configurations AS 0 can
+also represent a cache miss or non forwarded traffic so use with caution.
+.TP
+\fB-d\fI debug_level\fB\fR
+Enable debugging.
+.TP
+\fB-f\fI filter_fname\fB\fR
+Filter list filename.  Defaults to \fI@sysconfdir@/cfg/filter\fR\&.
+.TP
+\fB-F\fI filter_definition\fB\fR
+Select the active definition.  Defaults to default.
+.TP
+\fB-h\fR
+Display help.
+.TP
+\fB-m\fI privacy_mask\fB\fR
+Apply \fIprivacy_mask\fR to the source and destination IP
+address of flows.  For example a privacy_mask of 255.255.255.0 would convert
+flows with source/destination IP addresses 10.1.1.1 and 10.2.2.2 to 10.1.1.0
+and 10.2.2.0 respectively.
+.TP
+\fB-p\fI pidfile\fB\fR
+Configure the process ID file.  Use - to disable pid file creation.
+.TP
+\fB-s\fR
+Spoof the source IP address.  If the IP address is 0 then it is replaced
+with the exporter source IP.
+.TP
+\fB-S\fI stat_interval\fB\fR
+When configured \fBflow-fanout\fR will emit a timestamped
+message on stderr every \fIstat_interval\fR minutes
+indicating counters such as the number of flows received, packets processed,
+and lost flows.
+.TP
+\fB-V\fI pdu_version\fB\fR
+Use \fIpdu_version\fR format output.
+
+.nf
+    1    NetFlow version 1 (No sequence numbers, AS, or mask)
+    5    NetFlow version 5
+    6    NetFlow version 6 (5+ Encapsulation size)
+    7    NetFlow version 7 (Catalyst switches)
+    8.1  NetFlow AS Aggregation
+    8.2  NetFlow Proto Port Aggregation
+    8.3  NetFlow Source Prefix Aggregation
+    8.4  NetFlow Destination Prefix Aggregation
+    8.5  NetFlow Prefix Aggregation
+    8.6  NetFlow Destination (Catalyst switches)
+    8.7  NetFlow Source Destination (Catalyst switches)
+    8.8  NetFlow Full Flow (Catalyst switches)
+    8.9  NetFlow ToS AS Aggregation
+    8.10 NetFlow ToS Proto Port Aggregation
+    8.11 NetFlow ToS Source Prefix Aggregation
+    8.12 NetFlow ToS Destination Prefix Aggregation
+    8.13 NetFlow ToS Prefix Aggregation
+    8.14 NetFlow ToS Prefix Port Aggregation
+    1005 Flow-Tools tagged version 5
+.fi
+.TP
+\fB-x\fI xmit_delay\fB\fR
+Configure a microsecond transmit delay between packets.  This may be necessary in some configurations to prevent a transmit buffer overrun.
+.SH "EXAMPLES"
+.PP
+.PP
+Replicate flows arriving to local IP address 10.0.0.1 from the router
+exporting with IP address 10.1.1.1 on port 9500 to localhost port 9500
+and 10.5.5.5 port 9200.  The exports sent to 10.5.5.5 will be sent with
+a source IP address of 10.0.0.5 which must be a valid local IP address.
+.PP
+\fBflow-fanout 10.0.0.1/10.1.1.1/9500 0/0/9500 10.0.0.5/10.5.5.5/9200\fR
+.SH "BUGS"
+.PP
+NetFlow exports do not contain the exporter IP address inside the payload so
+the original exporter IP address (typically a router) will be lost when using
+\fBflow-fanout\fR\&.  A work around for this protocol limitation
+is to use local IP aliases and the \fIlocalip\fR option.
+When the spoofing option is used multiple exporters with different IP addresses
+will share the same sequence number but will have the original source IP.
+Fixing this requires per source : destination sequence number mapping.  It
+is much easier to just use multiple instances of flow-fanout running on
+different ports.
+.SH "AUTHOR"
+.PP
+MarkFullmer
+<maf@splintered.net>
+.SH "SEE ALSO"
+.PP
+\fBflow-tools\fR(1)
